{% extends 'page.html' %}
{% block bodytag %}{{ super() }} class="blog"{% endblock %}
{% block subtitle %}{{ c.page.title }}{% endblock %}


{% block primary_content %}
  <section class="module-content">
    {% if h.check_access('ckanext_pages_update') %}
      {# {% link_for _('Edit'), controller='ckanext.pages.controller:PagesController', action='blog_edit', page='/' + c.page.name, class_='btn btn-primary pull-right', icon='edit' %} #}
      {# {% link_for _('Edit'), controller = '/', action = 'blog_edit/' + c.page.name, class_='btn btn-primary pull-right', icon='edit' %} #}
      <button class="btn btn-primary pull-right" id = "edit-button">
          <a style = "color: white;" href = "{{ h.url_for('/blog_edit/' + c.page.name) }}"> 
            <i class = "fa fa-edit"></i>
            Edit </a>
      </button>

      {% else %}
    {% block social %}
      <div class="blog-social-icons pull-right">
        <a href="https://twitter.com/share?url=https://opendata.com.pk{{ h.url_for(controller='ckanext.pages.controller:PagesController', action='blog_show', page='/' + c.page.name) }}" target="_blank">
            <img class = "blog-social-icons" style = "height: 42px; width: 42px; filter: invert(48%) sepia(67%) saturate(1925%) hue-rotate(163deg) brightness(98%) contrast(103%);" src = "/images/twitter.svg">
        </a>
        <a href="https://www.facebook.com/sharer.php?u=https://opendata.com.pk{{ h.url_for(controller='ckanext.pages.controller:PagesController', action='blog_show', page='/' + c.page.name) }}" target="_blank">
            <img class = "blog-social-icons" style = "height: 42px; width: 42px; filter: invert(33%) sepia(10%) saturate(3075%) hue-rotate(183deg) brightness(96%) contrast(89%);" src = "/images/fb.svg">
        </a>
      </div>
    {% endblock %}

    {% endif %}
    <h1 class="page-heading">{{ c.page.title }}</h1>
      {% if c.page.publish_date %}
         <span class="muted date"> {{ h.render_datetime(c.page.publish_date) }} </span>
      {% endif %}
    {% if c.page.content %}
    {% set editor = h.get_wysiwyg_editor() %}
      {% if editor %}
        <div>
            <br>
            {{c.page.content|safe}}
        </div>
      {% else %}
        {{ h.render_content(c.page.content) }}
      {% endif %}
    {% else %}
      <p class="empty">{{ _('This page currently has no content') }}</p>
    {% endif %}
  </section>
{% endblock %}

{% block secondary_content %}

{% set posts = h.get_recent_blog_posts(number=5, exclude=c.page.name) %}
  <div class="module module-narrow module-shallow">
    <h2 class="module-heading">
      {{ _('Blog') }}
    </h2>
    <div class="module-content">
        {% for post in posts %}
        <a href="https://www.facebook.com">facebook</a>
            <div class="blog-title">
                <h3 class="dataset-heading">
                    <a href="{{ h.url_for('/blog/' + post.name) }}">{{ post.title or post.name}} </a>
                    <br>
                    {% if post.publish_date %}
                        <small style = "font-size: 11px;"> {{ h.render_datetime(post.publish_date) }} </small>
                    {% endif %}
                </h3>
            </div>
            <div class="blog-content">
                {{ h.markdown_extract(post.content) }}
                {% if post.publish_date %}
                   <p> {{ post.content | truncate(10) }} </p>
                   <hr>
                {% endif %}
            </div>
        {% endfor %}
    </div>
  </div>

{% asset 'ckanext-pages/blog' %}
{% endblock %}

